// superscore - v0.2.0 - 2012-06-03
// https://github.com/DavidSouther/superscore
// Copyright (c) 2012 David Souther; Licensed MIT
(function(a,b){"use strict";var c=b?b.ajax:function(b){var c,d=a.Deferred();return c=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP"),c.open(b.type||"GET",b.url,!0),"overrideMimeType"in c&&c.overrideMimeType(b.dataType||"text/plain"),c.onreadystatechange=function(){var a;if(c.readyState===4){(a=c.status)===0||a===200?d.resolve(c.responseText):d.reject(new Error("Could not load "+b.url));return}d.notify(c)},b.data&&(c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.setRequestHeader("Content-length",b.data.length),c.setRequestHeader("Connection","close")),c.send(b.data||null),d.promise()},d=b?b.get:function(b,c){return c=c||{},c.url=b,c.type="GET",c.data=null,a.ajax(c)},e=b?b.post:function(b,c){return c=c||{},c.url=b,c.type="POST",a.ajax(c)};a.mixin({ajax:c,get:d,post:e})}).call(this,_,jQuery||null),function(a,b){"use strict",a.mixin({indexBy:function(a,b){a=a||[],b=b||function(){return!1};for(var c=0,d=a.length;c<d;c++)if(b(a[c]))return c;return-1},noop:function(){}})}.call(this,_,jQuery),function(a,b){function e(a){var b=d[a]={},c,e;a=a.split(/\s+/);for(c=0,e=a.length;c<e;c++)b[a[c]]=!0;return b}var c={},d={};c.Callbacks=b?b.Callbacks:function(a){a=a?d[a]||e(a):{};var b=[],c=[],f,g,h,i,j,k,l=function(c){var d,e,f,g,h;for(d=0,e=c.length;d<e;d++)f=c[d],g=_type(f),g==="array"?l(f):g==="function"&&(!a.unique||!n.has(f))&&b.push(f)},m=function(d,e){e=e||[],f=!a.memory||[d,e],g=!0,h=!0,k=i||0,i=0,j=b.length;for(;b&&k<j;k++)if(b[k].apply(d,e)===!1&&a.stopOnFalse){f=!0;break}h=!1,b&&(a.once?f===!0?n.disable():b=[]:c&&c.length&&(f=c.shift(),n.fireWith(f[0],f[1])))},n={add:function(){if(b){var a=b.length;l(arguments),h?j=b.length:f&&f!==!0&&(i=a,m(f[0],f[1]))}return this},remove:function(){if(b){var c=arguments,d=0,e=c.length;for(;d<e;d++)for(var f=0;f<b.length;f++)if(c[d]===b[f]){h&&f<=j&&(j--,f<=k&&k--),b.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(b){var c=0,d=b.length;for(;c<d;c++)if(a===b[c])return!0}return!1},empty:function(){return b=[],this},disable:function(){return b=c=f=undefined,this},disabled:function(){return!b},lock:function(){return c=undefined,(!f||f===!0)&&n.disable(),this},locked:function(){return!c},fireWith:function(b,d){return c&&(h?a.once||c.push([b,d]):(!a.once||!f)&&m(b,d)),this},fire:function(){return n.fireWith(this,arguments),this},fired:function(){return!!g}};return n},c.Deferred=b?b.Deferred:function(a){var b=c.Callbacks("once memory"),d=c.Callbacks("once memory"),e=c.Callbacks("memory"),f="pending",g={resolve:b,reject:d,notify:e},h={done:b.add,fail:d.add,progress:e.add,state:function(){return f},isResolved:b.fired,isRejected:d.fired,then:function(a,b,c){return i.done(a).fail(b).progress(c),this},always:function(){return i.done.apply(i,arguments).fail.apply(i,arguments),this},pipe:function(a,b,d){return c.Deferred(function(c){_each({done:[a,"resolve"],fail:[b,"reject"],progress:[d,"notify"]},function(a,b){var d=a[0],e=a[1],f;_isFunction(d)?i[b](function(){f=d.apply(this,arguments),f&&_isFunction(f.promise)?f.promise().then(c.resolve,c.reject,c.notify):c[e+"With"](this===i?c:this,[f])}):i[b](c[e])})}).promise()},promise:function(a){if(!a)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;return i.done(function(){f="resolved"},d.disable,e.lock).fail(function(){f="rejected"},b.disable,e.lock),a&&a.call(i,i),i},c.when=b?b.when:function(a){function k(a){return function(c){b[a]=arguments.length>1?slice.call(arguments,0):c,--g||i.resolveWith(i,b)}}function l(a){return function(b){f[a]=arguments.length>1?slice.call(arguments,0):b,i.notifyWith(j,f)}}var b=slice.call(arguments,0),d=0,e=b.length,f=new Array(e),g=e,h=e,i=e<=1&&a&&_isFunction(a.promise)?a:c.Deferred(),j=i.promise();if(e>1){for(;d<e;d++)b[d]&&b[d].promise&&_isFunction(b[d].promise)?b[d].promise().then(k(d),i.reject,l(d)):--g;g||i.resolveWith(i,b)}else i!==a&&i.resolveWith(i,e?[a]:[]);return j},a.mixin(c)}.call(this,_,$),function(a,b){"use strict";var c=a.extend,d=Object.prototype.hasOwnProperty,e=b?b.extend:function(){var b,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;typeof h=="boolean"&&(k=h,h=arguments[1]||{},i=2),typeof h!="object"&&!a.isFunction(h)&&(h={}),j===i&&(h=this,--i);for(;i<j;i++)if((b=arguments[i])!==null)for(c in b){d=h[c],e=b[c];if(h===e)continue;k&&e&&(a.isPlainObject(e)||(f=a.isArray(e)))?(f?(f=!1,g=d&&a.isArray(d)?d:[]):g=d&&a.isPlainObject(d)?d:{},h[c]=a.extend(k,g,e)):e!==undefined&&(h[c]=e)}return h},f=b?b.isPlainObject:function(b){if(!b||a.type(b)!=="object"||b.nodeType||a.isWindow(b))return!1;try{if(b.constructor&&!d.call(b,"constructor")&&!d.call(b.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var e;for(e in b);return e===undefined||d.call(b,e)},g=b?b.isWindow:function(a){return a!==null&&a==a.window};a.mixin({_extend:c,extend:e,isPlainObject:f,isWindow:g})}.call(this,_,jQuery||null),function(a,b){"use strict",a.mixin({on:function(c,d,e){return a.isElement(c)&&b?b(c).on(d,e):(this.isString(c)&&(e=d,d=c,c=this),this.isUndefined(c.__event_handlers)&&(c.__event_handlers={}),d in c.__event_handlers||(c.__event_handlers[d]=[]),c.__event_handlers[d].push(e),this)},once:function(c,d,e){if(a.isElement(c)&&b)return b(c).one(d,e);var f=function(){a.removeEvent(c,d)};e=a.compose(f,e),this.on(c,d,e)},trigger:function(c,d,e){if(a.isElement(c)&&b)return b(c).trigger(d,e);this.isString(c)&&(e=d,d=c,c=this);if(this.isUndefined(c._events))return;if(d in c.__event_handlers){var f=c.__event_handlers[d].concat();for(var g=0,h=f.length;g<h;g++)f[g].apply(c,e===undefined?[]:e)}return this},off:function(c,d,e){if(a.isElement(c)&&b)return b(c).off(d,e);this.isString(c)&&(d=c,c=this);if(this.isUndefined(c.__event_handlers))return;return c.__event_handlers=a.filter(c.__event_handlers,function(a){return a.toString()===e.toString()}),this}})}.call(this,_,jQuery||null),function(a){var b={},c={},d={};b.rvalid=/^\{?[0-9a-f]{8}\-?[0-9a-f]{4}\-?[0-9a-f]{4}\-?[0-9a-f]{4}\-?[0-9a-f]{12}\}?$/i,b.v4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a==="x"?b:b&3|8;return c.toString(16)})},b.v5=function(a,b){var d=e(b||"00000000-0000-0000-0000-000000000000"),f=c.hash(d+a,!0),g=f.substring(0,8)+"-"+f.substring(8,12)+"-"+(parseInt(f.substring(12,16),16)&4095|20480).toString(16)+"-"+(parseInt(f.substring(16,20),16)&16383|32768).toString(16)+"-"+f.substring(20,32);return g};var e=function(a){if(!a.match(b.rvalid))return!1;var c=a.replace(/[\-{}]/g,""),d="";for(var e=0;e<c.length;e+=2)d+=String.fromCharCode(parseInt(c.charAt(e)+c.charAt(e+1),16));return d};c.hash=function(a,b){var e,f;b=typeof b=="undefined"?!0:b,b&&(a=d.encode(a));var g=[1518500249,1859775393,2400959708,3395469782];a+=String.fromCharCode(128);var h=a.length/4+2,i=Math.ceil(h/16),j=new Array(i);for(e=0;e<i;e++){j[e]=new Array(16);for(var k=0;k<16;k++)j[e][k]=a.charCodeAt(e*64+k*4)<<24|a.charCodeAt(e*64+k*4+1)<<16|a.charCodeAt(e*64+k*4+2)<<8|a.charCodeAt(e*64+k*4+3)}j[i-1][14]=(a.length-1)*8/Math.pow(2,32),j[i-1][14]=Math.floor(j[i-1][14]),j[i-1][15]=(a.length-1)*8&4294967295;var l=1732584193,m=4023233417,n=2562383102,o=271733878,p=3285377520,q=new Array(80),r,s,t,u,v;for(e=0;e<i;e++){for(f=0;f<16;f++)q[f]=j[e][f];for(f=16;f<80;f++)q[f]=c.ROTL(q[f-3]^q[f-8]^q[f-14]^q[f-16],1);r=l,s=m,t=n,u=o,v=p;for(f=0;f<80;f++){var w=Math.floor(f/20),x=c.ROTL(r,5)+c.f(w,s,t,u)+v+g[w]+q[f]&4294967295;v=u,u=t,t=c.ROTL(s,30),s=r,r=x}l=l+r&4294967295,m=m+s&4294967295,n=n+t&4294967295,o=o+u&4294967295,p=p+v&4294967295}return c.toHexStr(l)+c.toHexStr(m)+c.toHexStr(n)+c.toHexStr(o)+c.toHexStr(p)},c.f=function(a,b,c,d){switch(a){case 0:return b&c^~b&d;case 1:return b^c^d;case 2:return b&c^b&d^c&d;case 3:return b^c^d}},c.ROTL=function(a,b){return a<<b|a>>>32-b},c.toHexStr=function(a){var b="",c;for(var d=7;d>=0;d--)c=a>>>d*4&15,b+=c.toString(16);return b},d.encode=function(a){var b=a.replace(/[\u0080-\u07ff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(192|b>>6,128|b&63)});return b=b.replace(/[\u0800-\uffff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(224|b>>12,128|b>>6&63,128|b&63)}),b},d.decode=function(a){var b=a.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){var b=(a.charCodeAt(0)&15)<<12|(a.charCodeAt(1)&63)<<6|a.charCodeAt(2)&63;return String.fromCharCode(b)});return b=b.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){var b=(a.charCodeAt(0)&31)<<6|a.charCodeAt(1)&63;return String.fromCharCode(b)}),b},a.extend({UUID:b,Utf8:d,Sha1:c})}.call(this,_);